<!DOCTYPE html>
<html>
<head>
  <title>Notification Sound</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #0070f3;
      color: white;
      border: none;
      border-radius: 5px;
      margin: 10px;
    }
    .instructions {
      max-width: 600px;
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Notification Sound</h1>
  
  <div>
    <button id="playSound">Play Notification Sound</button>
    <button id="downloadSound">Download Sound File</button>
  </div>
  
  <div class="instructions">
    <p>1. Click "Download Sound File" to save the notification sound</p>
    <p>2. Place the downloaded MP3 file in your project's /public folder</p>
    <p>3. The notification system will use this sound when new replies are received</p>
  </div>

  <script>
    // Create a notification sound using Web Audio API
    function createNotificationSound() {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(587.33, audioContext.currentTime); // D5
      oscillator.frequency.setValueAtTime(880, audioContext.currentTime + 0.2); // A5
      
      gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.start();
      oscillator.stop(audioContext.currentTime + 0.5);
      
      return audioContext;
    }
    
    // Play sound when button is clicked
    document.getElementById('playSound').addEventListener('click', function() {
      createNotificationSound();
    });
    
    // Generate and download the notification sound
    document.getElementById('downloadSound').addEventListener('click', function() {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const duration = 0.5;
      const frameCount = audioContext.sampleRate * duration;
      const audioBuffer = audioContext.createBuffer(1, frameCount, audioContext.sampleRate);
      
      const channelData = audioBuffer.getChannelData(0);
      
      for (let i = 0; i < frameCount; i++) {
        const t = i / audioContext.sampleRate;
        
        // First note for 0.2 seconds
        if (t < 0.2) {
          channelData[i] = 0.5 * Math.sin(2 * Math.PI * 587.33 * t) * Math.exp(-3 * t);
        } 
        // Second note for remaining time
        else {
          channelData[i] = 0.5 * Math.sin(2 * Math.PI * 880 * t) * Math.exp(-3 * t);
        }
      }
      
      // Create a WAV file
      const wavBlob = bufferToWav(audioBuffer);
      
      // Create download link
      const url = URL.createObjectURL(wavBlob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'notification-sound.mp3';
      a.click();
      URL.revokeObjectURL(url);
    });
    
    // Convert audio buffer to WAV file
    function bufferToWav(buffer) {
      const numOfChannels = buffer.numberOfChannels;
      const length = buffer.length * numOfChannels * 2;
      const sampleRate = buffer.sampleRate;
      
      const wavData = new ArrayBuffer(44 + length);
      const view = new DataView(wavData);
      
      // Write WAV header
      writeString(view, 0, 'RIFF');
      view.setUint32(4, 36 + length, true);
      writeString(view, 8, 'WAVE');
      writeString(view, 12, 'fmt ');
      view.setUint32(16, 16, true);
      view.setUint16(20, 1, true);
      view.setUint16(22, numOfChannels, true);
      view.setUint32(24, sampleRate, true);
      view.setUint32(28, sampleRate * numOfChannels * 2, true);
      view.setUint16(32, numOfChannels * 2, true);
      view.setUint16(34, 16, true);
      writeString(view, 36, 'data');
      view.setUint32(40, length, true);
      
      // Write audio data
      const data = new Float32Array(buffer.length * numOfChannels);
      let offset = 0;
      
      for (let i = 0; i < buffer.numberOfChannels; i++) {
        data.set(buffer.getChannelData(i), offset);
        offset += buffer.length;
      }
      
      const volume = 0.5;
      for (let i = 0; i < data.length; i++) {
        const s = Math.max(-1, Math.min(1, data[i] * volume));
        view.setInt16(44 + i * 2, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
      }
      
      return new Blob([wavData], { type: 'audio/wav' });
    }
    
    function writeString(view, offset, string) {
      for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
      }
    }
  </script>
</body>
</html> 